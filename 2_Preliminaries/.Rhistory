res = map(out, 1)
res_eig = map(out, 2)
res_eig_min = map(out, 3)
R_hat = map(out, 4)
par(mfrow=c(1,3))
plot_fig1_a(Re(R_hat[[7]]), m=10, 2, 0)
plot_fig1_bc(res, res_eig, res_eig_min)
# 1000 MC samples ---------------------------------------------------------
#T=1000
out <- readRDS("L:/Paper_Code/Section 2/Supplementary/1000/T_1000.RDS")
res = map(out, 1)
res_eig = map(out, 2)
res_eig_min = map(out, 3)
R_hat = map(out, 4)
par(mfrow=c(1,3))
plot_fig1_a(Re(R_hat[[7]]), m=10, 2, 0)
plot_fig1_bc(res, res_eig, res_eig_min)
#T=100
out <- readRDS("L:/Paper_Code/Section 2/Supplementary/1000/T_100.RDS")
res = map(out, 1)
res_eig = map(out, 2)
res_eig_min = map(out, 3)
R_hat = map(out, 4)
par(mfrow=c(1,3))
plot_fig1_a(Re(R_hat[[7]]), m=10, 2, 0)
plot_fig1_bc(res, res_eig, res_eig_min)
#T=10
out <- readRDS("L:/Paper_Code/Section 2/Supplementary/1000/T_10.RDS")
res = map(out, 1)
res_eig = map(out, 2)
res_eig_min = map(out, 3)
R_hat = map(out, 4)
par(mfrow=c(1,3))
plot_fig1_a(Re(R_hat[[7]]), m=10, 2, 0)
plot_fig1_bc(res, res_eig, res_eig_min)
setwd("~/Downloads/RSE/2_Preliminaries")
source("Functions_Section_2.R")
source("~/Downloads/RSE/2_Preliminaries/Empirical_Properties_TA_Periodogram.R", echo=TRUE)
library(Matrix)
library(phonTools)
library(QZ)
library(purrr)
library(matrixStats)
library(complexplus)
library(psych)
library(pracma)
library(hawkes)
library(hypergeo)
setwd("~/Downloads/RSE/2_Preliminaries")
source("Functions_Section_2.R")
res = readRDS("sup_norm.RDS")
res_eig = readRDS("max_eig.RDS")
res_eig_min = readRDS("min_eig.RDS")
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#par(mar=c(6,7,4,2)+1.3, mgp=c(5.5,1.5,0))
par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
#par(mar=c(6,7,4,2)+0.1, mgp=c(3.8,1,0))
par(mar = c(5,4,4,2) + 1.5, mgp=c(3,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(0,0.4), las=1, family="serif")
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
R_hat <- readRDS("~/luna/Paper_Code/Section 2/Data/R_hat1.RDS")
m=10
p = plot_both_corr(R_hat, m, 2, 0)
plot_fig1_a(R_hat, m,p, 0)
plot_fig1_a(R_hat, m,2, 0)
plot_fig1_bc(res, res_eig, res_eig_min)
plot_fig1_bc
plot_fig1_bc(res, res_eig, res_eig_min)
plot_fig1_a(R_hat, m, 2, 0)
plot_fig1_bc(res, res_eig, res_eig_min)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
axis(2, at = round(mean_res, 4), labels = round(mean_res, 4) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
plot_fig1_bc(res, res_eig, res_eig_min)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
axis(2, at = round(mean_res, 2), labels = round(mean_res, 2) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
plot_fig1_bc(res, res_eig, res_eig_min)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
axis(2, at = round(mean_res, 2), labels = round(mean_res, 0) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
plot_fig1_bc(res, res_eig, res_eig_min)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
axis(2, at = round(mean_res, 2), labels = round(mean_res, 2) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
plot_fig1_bc(res, res_eig, res_eig_min)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
axis(2, at = round(mean_res, 0), labels = round(mean_res, 2) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
plot_fig1_bc(res, res_eig, res_eig_min)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
axis(2, at = round(mean_res, 2), labels = round(mean_res, 2) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
plot_fig1_bc(res, res_eig, res_eig_min)
seq(0, 0.35, length.out=8)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
#axis(2, at = round(mean_res, 2), labels = round(mean_res, 2) , cex.axis = 2, las =1)
axis(2, at = seq(0, 0.35, length.out=8), labels =seq(0, 0.35, length.out=8) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
seq(0, 0.35, length.out=8)
plot_fig1_bc(res, res_eig, res_eig_min)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
#axis(2, at = round(mean_res, 2), labels = round(mean_res, 2) , cex.axis = 2, las =1)
axis(2, at = seq(0, 0.35, length.out=8), labels =round(seq(0, 0.35, length.out=8),2) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
plot_fig1_bc(res, res_eig, res_eig_min)
2*pi*seq(1,50)/1000
2*pi
pi/2
source("~/Downloads/RSE/2_Preliminaries/Empirical_Properties_TA_Periodogram_alt_freq.R", echo=TRUE)
library(Matrix)
library(phonTools)
library(QZ)
library(purrr)
library(matrixStats)
library(complexplus)
library(psych)
library(pracma)
library(hawkes)
library(hypergeo)
setwd("~/Downloads/RSE/2_Preliminaries")
source("Functions_Section_2.R")
R_hat <- readRDS("~/luna/Paper_Code/Section 2/Data/R_hat1.RDS")
m=10
plot_fig1_a(R_hat, m, 2, 0)
res = readRDS("sup_norm.RDS")
res_eig = readRDS("max_eig.RDS")
res_eig_min = readRDS("min_eig.RDS")
plot_fig1_bc(res, res_eig, res_eig_min)
mean_res = unlist(lapply(res, mean))
res2 = readRDS("sup_norm2.RDS")
res_eig2 = readRDS("max_eig2.RDS")
res_eig_min2 = readRDS("min_eig2.RDS")
R_hat2 <- readRDS("~/luna/Paper_Code/Section 2/Data/R_hat1_alt.RDS")
R_hat2 <- readRDS("R_hat1_alt.RDS")
plot_fig1_a(R_hat2, m, 2, 0)
dim(R_hat2)
R_hat == R_hat2
all.equal(res,res2)
all.equal(res_eig,res_eig2)
all.equal(res_eig_min,res_eig_min2)
length(res_eig_min)
length(res_eig_min2)
plot_fig1_bc(res2, res_eig2, res_eig_min2)
plot_fig1_bc
library(Matrix)
library(phonTools)
library(QZ)
library(purrr)
library(matrixStats)
library(complexplus)
library(psych)
library(pracma)
library(hawkes)
library(hypergeo)
setwd("~/Downloads/RSE/2_Preliminaries")
source("Functions_Section_2.R")
m=10
res2 = readRDS("sup_norm2.RDS")
res_eig2 = readRDS("max_eig2.RDS")
res_eig_min2 = readRDS("min_eig2.RDS")
R_hat2 <- readRDS("R_hat1_alt.RDS")
plot_fig1_a(R_hat2, m, 2, 0)
plot_fig1_bc(res2, res_eig2, res_eig_min2)
seq(0, 0.35, length.out=8)
round(seq(0, 0.35, length.out=8),4)
round(seq(0, 0.35, length.out=8),5)
round(seq(0, 0.35, length.out=8),1)
round(seq(0, 0.35, length.out=8),2)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
#axis(2, at = round(mean_res, 2), labels = round(mean_res, 2) , cex.axis = 2, las =1)
axis(2, at = seq(0, 0.35, length.out=8), labels =round(seq(0, 0.35, length.out=8),4) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
plot_fig1_bc(res2, res_eig2, res_eig_min2)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
#axis(2, at = round(mean_res, 2), labels = round(mean_res, 2) , cex.axis = 2, las =1)
axis(2, at = round(seq(0, 0.35, length.out=8),2), labels =round(seq(0, 0.35, length.out=8),4) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
plot_fig1_bc(res2, res_eig2, res_eig_min2)
round(0,5)
z = seq(0, 0.34, length.out=8)
sprintf("%.2f", z)
# 5. Plotting Figure 1b and 1c --------------------------------------------------
plot_fig1_bc = function(res, res_eig, res_eig_min){
mean_res = unlist(lapply(res, mean))
mean_lower = unlist(lapply(res, quantile, probs=0.025))
mean_upper = unlist(lapply(res, quantile, probs = 0.975))
mean_res_eig = unlist(lapply(res_eig, mean))
eig_lower = unlist(lapply(res_eig, quantile, probs=0.025))
eig_upper = unlist(lapply(res_eig, quantile, probs = 0.975))
mean_res_eig_min = unlist(lapply(res_eig_min, mean))
eig_min_lower = unlist(lapply(res_eig_min, quantile, probs=0.025))
eig_min_upper = unlist(lapply(res_eig_min, quantile, probs = 0.975))
#fig 1b
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
plot(seq(1,100), (mean_res), type='l', xlab = "p", ylab = expression(paste("||", hat(S)(omega)-S(omega),"||", infinity)),
cex.axis = 2, cex.lab =2, ylim = c(min(mean_lower),max(mean_upper)), las=1, family="serif", axes = F, frame.plot = T)
#axis(2, at = round(mean_res, 2), labels = round(mean_res, 2) , cex.axis = 2, las =1)
labs = seq(0, 0.35, length.out=8)
axis(2, at = round(seq(0, 0.35, length.out=8),2), labels = sprintf("%.2f", labs) , cex.axis = 2, las =1)
lines(seq(1,100), (mean_lower), col="brown2", lwd=1)
lines(seq(1,100), (mean_upper), col="brown2", lwd=1)
abline(v=10, lty=2, lwd=1)
#fig 1c
par(mar = c(5,4,4,2) + 2.5, mgp=c(4,1,0))
#par(mar = c(5,4,4,2) + 1, mgp=c(3.5,1,0))
plot(seq(1,10), (mean_res_eig/mean_res_eig_min)[1:10], type='l',xlab = "p",
ylab = expression(phi["max"]/phi["min"]) ,xlim=c(0,10),
cex.axis = 2, cex.lab=2, lwd=1, las = 1, cex.axis =2, family = "serif")
lines(seq(1,10), (eig_lower/eig_min_lower)[1:10], col="brown2", lwd=1)
lines(seq(1,10), (eig_upper/eig_min_upper)[1:10], col="brown2", lwd=1)
}
plot_fig1_bc(res2, res_eig2, res_eig_min2)
# Plots for Section 2  ----------------------------------------------------
library(Matrix)
library(phonTools)
library(QZ)
library(purrr)
library(matrixStats)
library(complexplus)
library(psych)
library(pracma)
library(hawkes)
library(hypergeo)
setwd("~/Downloads/RSE/2_Preliminaries")
source("Functions_Section_2.R")
# Fig1.a Plot -----------------------------------------------------------
R_hat <- readRDS("~/luna/Paper_Code/Section 2/Data/R_hat1.RDS")
m=10
plot_fig1_a(R_hat, m, 2, 0)
res = readRDS("sup_norm.RDS")
res_eig = readRDS("max_eig.RDS")
res_eig_min = readRDS("min_eig.RDS")
# Fig1.b and c Plot -----------------------------------------------------------
plot_fig1_bc(res, res_eig, res_eig_min)
# plots for alternative frequency -----------------------------------------
res2 = readRDS("sup_norm2.RDS")
res_eig2 = readRDS("max_eig2.RDS")
res_eig_min2 = readRDS("min_eig2.RDS")
R_hat2 <- readRDS("R_hat1_alt.RDS")
plot_fig1_a(R_hat2, m, 2, 0)
plot_fig1_bc(res2, res_eig2, res_eig_min2)
source("~/Downloads/RSE/2_Preliminaries/Plotting_Section_2.R", echo=TRUE)
source("~/Downloads/RSE/2_Preliminaries/Plotting_Section_2.R", echo=TRUE)
source("~/Downloads/RSE/2_Preliminaries/Plotting_Section_2.R", echo=TRUE)
pi/2
